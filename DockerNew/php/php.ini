[PHP]
; Production Memory Settings
memory_limit = 512M

; File Upload Limits - Production Optimized
upload_max_filesize = 64M
post_max_size = 64M
max_file_uploads = 20

; Execution Time Limits - Production Optimized
max_execution_time = 120
max_input_time = 120
max_input_vars = 3000

; Error Reporting - Production Security
error_reporting = E_ALL & ~E_DEPRECATED & ~E_STRICT
display_errors = Off
display_startup_errors = Off
log_errors = On
error_log = /var/log/php_errors.log

; Security Settings
expose_php = Off
allow_url_fopen = Off
allow_url_include = Off

; Session Security - Database-based (No Redis)
session.use_strict_mode = 1
session.use_cookies = 1
session.use_only_cookies = 1
session.cookie_httponly = 1
session.cookie_secure = 1
session.cookie_samesite = "Strict"
session.entropy_length = 64
session.entropy_file = /dev/urandom
session.hash_function = sha256

; Database Session Settings (Simple & Reliable - No Redis)
session.save_handler = files
session.save_path = "/tmp"

; Timezone
date.timezone = "Asia/Jakarta"

; Output buffering - Optimized for Laravel
output_buffering = 4096
zlib.output_compression = Off

; Performance Settings
realpath_cache_size = 16M
realpath_cache_ttl = 7200

; OPcache Settings (included here for reference, also in opcache.ini)
opcache.enable = 1
opcache.enable_cli = 0
opcache.memory_consumption = 256
opcache.interned_strings_buffer = 32
opcache.max_accelerated_files = 100000
opcache.revalidate_freq = 0
opcache.validate_timestamps = 0
opcache.save_comments = 0
opcache.fast_shutdown = 1
opcache.enable_file_override = 1
opcache.jit = 1255
opcache.jit_buffer_size = 128M

; APCu Settings (Alternative to Redis for local caching)
apc.enabled = 1
apc.shm_size = 128M
apc.enable_cli = 0
apc.ttl = 3600
apc.user_ttl = 3600
apc.gc_ttl = 3600

; Security Headers (additional to Caddy)
; These are handled by PHP for any direct PHP access

; Logging
log_errors_max_len = 1024
ignore_repeated_errors = On
ignore_repeated_source = On

; CGI Settings
cgi.fix_pathinfo = 0

; Disable dangerous functions for production security
disable_functions = exec,passthru,shell_exec,system,proc_open,popen,curl_exec,curl_multi_exec,parse_ini_file,show_source

; File handling
auto_detect_line_endings = Off
default_charset = "UTF-8"

; Mail function (if using local mail)
sendmail_path = /usr/sbin/sendmail -t -i

; Resource Limits
default_socket_timeout = 60

; Additional Production Hardening
user_ini.filename = ""
user_ini.cache_ttl = 300

; Comment: Redis configuration removed - sehat, kenapa harus pakai obat
; Using database-based sessions, cache, and queues for simplicity and reliability